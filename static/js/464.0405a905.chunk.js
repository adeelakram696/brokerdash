"use strict";(self.webpackChunkbroker_dashboard=self.webpackChunkbroker_dashboard||[]).push([[464],{9464:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Be});var n=t(5465),o=t(718),s=t(2746),i=t(4064),r=t(2612),l=t(9950),c=t(8738),d=t.n(c),u=t(7090),m=t(1929),p=t(6191),v=t(5741),g=t(5656),f=t(9415),_=t(183);const b=l.createContext({});var y=t(7409),h=t(5343),x=t(2672),j=t(1874);const A=e=>{const{antCls:a,componentCls:t,iconCls:n,avatarBg:o,avatarColor:s,containerSize:i,containerSizeLG:r,containerSizeSM:l,textFontSize:c,textFontSizeLG:d,textFontSizeSM:u,borderRadius:m,borderRadiusLG:p,borderRadiusSM:v,lineWidth:g,lineType:f}=e,_=(e,a,o)=>({width:e,height:e,borderRadius:"50%",["&".concat(t,"-square")]:{borderRadius:o},["&".concat(t,"-icon")]:{fontSize:a,["> ".concat(n)]:{margin:0}}});return{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,h.dF)(e)),{position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:s,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:o,border:"".concat((0,y.zA)(g)," ").concat(f," transparent"),"&-image":{background:"transparent"},["".concat(a,"-image-img")]:{display:"block"}}),_(i,c,m)),{"&-lg":Object.assign({},_(r,d,p)),"&-sm":Object.assign({},_(l,u,v)),"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}})}},w=e=>{const{componentCls:a,groupBorderColor:t,groupOverlapping:n,groupSpace:o}=e;return{["".concat(a,"-group")]:{display:"inline-flex",["".concat(a)]:{borderColor:t},"> *:not(:first-child)":{marginInlineStart:n}},["".concat(a,"-group-popover")]:{["".concat(a," + ").concat(a)]:{marginInlineStart:o}}}},O=(0,x.OF)("Avatar",(e=>{const{colorTextLightSolid:a,colorTextPlaceholder:t}=e,n=(0,j.h1)(e,{avatarBg:t,avatarColor:a});return[A(n),w(n)]}),(e=>{const{controlHeight:a,controlHeightLG:t,controlHeightSM:n,fontSize:o,fontSizeLG:s,fontSizeXL:i,fontSizeHeading3:r,marginXS:l,marginXXS:c,colorBorderBg:d}=e;return{containerSize:a,containerSizeLG:t,containerSizeSM:n,textFontSize:Math.round((s+i)/2),textFontSizeLG:r,textFontSizeSM:o,groupSpace:c,groupOverlapping:-l,groupBorderColor:d}}));var S=function(e,a){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)a.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t};const C=(e,a)=>{const[t,n]=l.useState(1),[o,s]=l.useState(!1),[i,r]=l.useState(!0),c=l.useRef(null),y=l.useRef(null),h=(0,m.K4)(a,c),{getPrefixCls:x,avatar:j}=l.useContext(v.QO),A=l.useContext(b),w=()=>{if(!y.current||!c.current)return;const a=y.current.offsetWidth,t=c.current.offsetWidth;if(0!==a&&0!==t){const{gap:o=4}=e;2*o<t&&n(t-2*o<a?(t-2*o)/a:1)}};l.useEffect((()=>{s(!0)}),[]),l.useEffect((()=>{r(!0),n(1)}),[e.src]),l.useEffect(w,[e.gap]);const C=()=>{const{onError:a}=e;!1!==(null===a||void 0===a?void 0:a())&&r(!1)},{prefixCls:z,shape:E,size:N,src:D,srcSet:k,icon:L,className:F,rootClassName:B,alt:P,draggable:R,children:M,crossOrigin:T}=e,I=S(e,["prefixCls","shape","size","src","srcSet","icon","className","rootClassName","alt","draggable","children","crossOrigin"]),q=(0,f.A)((e=>{var a,t;return null!==(t=null!==(a=null!==N&&void 0!==N?N:null===A||void 0===A?void 0:A.size)&&void 0!==a?a:e)&&void 0!==t?t:"default"})),G=Object.keys("object"===typeof q&&q||{}).some((e=>["xs","sm","md","lg","xl","xxl"].includes(e))),W=(0,_.A)(G),Y=l.useMemo((()=>{if("object"!==typeof q)return{};const e=p.ye.find((e=>W[e])),a=q[e];return a?{width:a,height:a,fontSize:a&&(L||M)?a/2:18}:{}}),[W,q]);const K=x("avatar",z),H=(0,g.A)(K),[V,X,Q]=O(K,H),Z=d()({["".concat(K,"-lg")]:"large"===q,["".concat(K,"-sm")]:"small"===q}),J=l.isValidElement(D),U=E||(null===A||void 0===A?void 0:A.shape)||"circle",$=d()(K,Z,null===j||void 0===j?void 0:j.className,"".concat(K,"-").concat(U),{["".concat(K,"-image")]:J||D&&i,["".concat(K,"-icon")]:!!L},Q,H,F,B,X),ee="number"===typeof q?{width:q,height:q,fontSize:L?q/2:18}:{};let ae;if("string"===typeof D&&i)ae=l.createElement("img",{src:D,draggable:R,srcSet:k,onError:C,alt:P,crossOrigin:T});else if(J)ae=D;else if(L)ae=L;else if(o||1!==t){const e="scale(".concat(t,")"),a={msTransform:e,WebkitTransform:e,transform:e};ae=l.createElement(u.A,{onResize:w},l.createElement("span",{className:"".concat(K,"-string"),ref:y,style:Object.assign({},a)},M))}else ae=l.createElement("span",{className:"".concat(K,"-string"),style:{opacity:0},ref:y},M);return delete I.onError,delete I.gap,V(l.createElement("span",Object.assign({},I,{style:Object.assign(Object.assign(Object.assign(Object.assign({},ee),Y),null===j||void 0===j?void 0:j.style),I.style),className:$,ref:h}),ae))};const z=l.forwardRef(C);var E=t(604),N=t(9156),D=t(1207),k=t(1478);const L=e=>e?"function"===typeof e?e():e:null;var F=t(9437),B=t(6680),P=t(9888),R=t(8691),M=t(6871),T=t(1201),I=t(8704);const q=e=>{const{componentCls:a,popoverColor:t,titleMinWidth:n,fontWeightStrong:o,innerPadding:s,boxShadowSecondary:i,colorTextHeading:r,borderRadiusLG:l,zIndexPopup:c,titleMarginBottom:d,colorBgElevated:u,popoverBg:m,titleBorderBottom:p,innerContentPadding:v,titlePadding:g}=e;return[{[a]:Object.assign(Object.assign({},(0,h.dF)(e)),{position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:c,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","--antd-arrow-background-color":u,width:"max-content",maxWidth:"100vw","&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},["".concat(a,"-content")]:{position:"relative"},["".concat(a,"-inner")]:{backgroundColor:m,backgroundClip:"padding-box",borderRadius:l,boxShadow:i,padding:s},["".concat(a,"-title")]:{minWidth:n,marginBottom:d,color:r,fontWeight:o,borderBottom:p,padding:g},["".concat(a,"-inner-content")]:{color:t,padding:v}})},(0,M.Ay)(e,"var(--antd-arrow-background-color)"),{["".concat(a,"-pure")]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow,display:"inline-block",["".concat(a,"-content")]:{display:"inline-block"}}}]},G=e=>{const{componentCls:a}=e;return{[a]:I.s.map((t=>{const n=e["".concat(t,"6")];return{["&".concat(a,"-").concat(t)]:{"--antd-arrow-background-color":n,["".concat(a,"-inner")]:{backgroundColor:n},["".concat(a,"-arrow")]:{background:"transparent"}}}}))}},W=(0,x.OF)("Popover",(e=>{const{colorBgElevated:a,colorText:t}=e,n=(0,j.h1)(e,{popoverBg:a,popoverColor:t});return[q(n),G(n),(0,R.aB)(n,"zoom-big")]}),(e=>{const{lineWidth:a,controlHeight:t,fontHeight:n,padding:o,wireframe:s,zIndexPopupBase:i,borderRadiusLG:r,marginXS:l,lineType:c,colorSplit:d,paddingSM:u}=e,m=t-n,p=m/2,v=m/2-a,g=o;return Object.assign(Object.assign(Object.assign({titleMinWidth:177,zIndexPopup:i+30},(0,T.n)(e)),(0,M.Ke)({contentRadius:r,limitVerticalRadius:!0})),{innerPadding:s?0:12,titleMarginBottom:s?0:l,titlePadding:s?"".concat(p,"px ").concat(g,"px ").concat(v,"px"):0,titleBorderBottom:s?"".concat(a,"px ").concat(c," ").concat(d):"none",innerContentPadding:s?"".concat(u,"px ").concat(g,"px"):0})}),{resetStyle:!1,deprecatedTokens:[["width","titleMinWidth"],["minWidth","titleMinWidth"]]});var Y=function(e,a){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)a.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t};const K=e=>{const{hashId:a,prefixCls:t,className:n,style:o,placement:s="top",title:i,content:r,children:c}=e;return l.createElement("div",{className:d()(a,t,"".concat(t,"-pure"),"".concat(t,"-placement-").concat(s),n),style:o},l.createElement("div",{className:"".concat(t,"-arrow")}),l.createElement(P.z,Object.assign({},e,{className:a,prefixCls:t}),c||((e,a,t)=>a||t?l.createElement(l.Fragment,null,a&&l.createElement("div",{className:"".concat(e,"-title")},L(a)),l.createElement("div",{className:"".concat(e,"-inner-content")},L(t))):null)(t,i,r)))},H=e=>{const{prefixCls:a,className:t}=e,n=Y(e,["prefixCls","className"]),{getPrefixCls:o}=l.useContext(v.QO),s=o("popover",a),[i,r,c]=W(s);return i(l.createElement(K,Object.assign({},n,{prefixCls:s,hashId:r,className:d()(t,c)})))};var V=function(e,a){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)a.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t};const X=e=>{let{title:a,content:t,prefixCls:n}=e;return l.createElement(l.Fragment,null,a&&l.createElement("div",{className:"".concat(n,"-title")},L(a)),l.createElement("div",{className:"".concat(n,"-inner-content")},L(t)))},Q=l.forwardRef(((e,a)=>{var t,n;const{prefixCls:o,title:s,content:i,overlayClassName:r,placement:c="top",trigger:u="hover",children:m,mouseEnterDelay:p=.1,mouseLeaveDelay:g=.1,onOpenChange:f,overlayStyle:_={}}=e,b=V(e,["prefixCls","title","content","overlayClassName","placement","trigger","children","mouseEnterDelay","mouseLeaveDelay","onOpenChange","overlayStyle"]),{getPrefixCls:y}=l.useContext(v.QO),h=y("popover",o),[x,j,A]=W(h),w=y(),O=d()(r,j,A),[S,C]=(0,D.A)(!1,{value:null!==(t=e.open)&&void 0!==t?t:e.visible,defaultValue:null!==(n=e.defaultOpen)&&void 0!==n?n:e.defaultVisible}),z=(e,a)=>{C(e,!0),null===f||void 0===f||f(e,a)};return x(l.createElement(B.A,Object.assign({placement:c,trigger:u,mouseEnterDelay:p,mouseLeaveDelay:g,overlayStyle:_},b,{prefixCls:h,overlayClassName:O,ref:a,open:S,onOpenChange:e=>{z(e)},overlay:s||i?l.createElement(X,{prefixCls:h,title:s,content:i}):null,transitionName:(0,F.b)(w,"zoom-big",b.transitionName),"data-popover-inject":!0}),(0,N.Ob)(m,{onKeyDown:e=>{var a,t;l.isValidElement(m)&&(null===(t=null===m||void 0===m?void 0:(a=m.props).onKeyDown)||void 0===t||t.call(a,e)),(e=>{e.keyCode===k.A.ESC&&z(!1,e)})(e)}})))}));Q._InternalPanelDoNotUseOrYouWillBeFired=H;const Z=Q,J=e=>{const{size:a,shape:t}=l.useContext(b),n=l.useMemo((()=>({size:e.size||a,shape:e.shape||t})),[e.size,e.shape,a,t]);return l.createElement(b.Provider,{value:n},e.children)},U=e=>{const{getPrefixCls:a,direction:t}=l.useContext(v.QO),{prefixCls:n,className:o,rootClassName:s,style:i,maxCount:r,maxStyle:c,size:u,shape:m,maxPopoverPlacement:p="top",maxPopoverTrigger:f="hover",children:_}=e,b=a("avatar",n),y="".concat(b,"-group"),h=(0,g.A)(b),[x,j,A]=O(b,h),w=d()(y,{["".concat(y,"-rtl")]:"rtl"===t},A,h,o,s,j),S=(0,E.A)(_).map(((e,a)=>(0,N.Ob)(e,{key:"avatar-key-".concat(a)}))),C=S.length;if(r&&r<C){const e=S.slice(0,r),a=S.slice(r,C);return e.push(l.createElement(Z,{key:"avatar-popover-key",content:a,trigger:f,placement:p,overlayClassName:"".concat(y,"-popover"),destroyTooltipOnHide:!0},l.createElement(z,{style:c},"+".concat(C-r)))),x(l.createElement(J,{shape:m,size:u},l.createElement("div",{className:w,style:i},e)))}return x(l.createElement(J,{shape:m,size:u},l.createElement("div",{className:w,style:i},S)))},$=z;$.Group=U;const ee=$;var ae=t(4051),te=t(326),ne=t(859),oe=t(6541),se=t(4159),ie=t.n(se),re=t(6338),le=t(9379);const ce=["Follow up call","Deal Submitted","Offer Received Back","Fully funded"],de={"total leads assigned":"# of Active Leads Assigned","leads assigned":"# of Leads Assigned","disqualified leads":"# of Leads Disqualified","follow up call":"Attempted Calls","deal submitted":"Deal Submitted","offer received back":"Approvals","contract out":"Contract out","contract signed":"Contract Signed","fully funded":"Deals Funded","client rejected":"Client Rejected",declined:"Declined",disqualified:"Disqualified","conversion ratio":"Conversion Ratio (Funded/Approvals)","avg deal size":"Avg Funded Deal Size","avg time to fund":"Avg Time from Application to Funded"},ue={"deal submitted":"leads assigned","offer received back":"deal submitted","fully funded":"offer received back"},me="LeaderBoards_table__u3STH",pe="LeaderBoards_headerRow__Bv7Lq",ve="LeaderBoards_headerColumnTitle__BbeRM",ge="LeaderBoards_dataColumnTitle__bj7wK",fe="LeaderBoards_headerColumnPerson__JzV2F",_e="LeaderBoards_dataColumnPerson__V8O69",be="LeaderBoards_dataRow__H-WEt",ye="LeaderBoards_filterbar__nKucZ",he="LeaderBoards_usersList__4ySG9",xe="LeaderBoards_filterField__14bMZ",je="LeaderBoards_alternateColor__iGVHE",Ae="LeaderBoards_percentage__J7lGV";var we=t(1397),Oe=t.n(we);const Se=async(e,a)=>{const t=a.map((e=>'"person-'.concat(e.id,'"'))),n="query {\n    boards(ids: [".concat(te._K.boards.leads,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.leads.assginee,'", compare_value: [').concat(t,'], operator: any_of}\n            { column_id: "').concat(te.zu.leads.stage,'", compare_value: [11,14], operator: not_any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.leads.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }');return await ne.A.api(n)},Ce=async(e,a)=>{var t,n,o,s;const i=a.map((e=>'"person-'.concat(e.id,'"'))),r="query {\n    boards(ids: [".concat(te._K.boards.deals,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.deals.assginee,'", compare_value: [').concat(i,'], operator: any_of}\n            { column_id: "').concat(te.zu.deals.stage,'", compare_value: [1,5,6,8,9,10,11,14], operator: not_any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.deals.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }'),l=await ne.A.api(r);return null!==l&&void 0!==l&&null!==(t=l.data)&&void 0!==t&&null!==(n=t.boards)&&void 0!==n&&null!==(o=n[0])&&void 0!==o&&null!==(s=o.items_page)&&void 0!==s&&s.items&&(l.data.boards[0].items_page.items=l.data.boards[0].items_page.items.map((e=>(0,le.A)((0,le.A)({},e),{},{isDeal:!0})))),l},ze=async(e,a,t)=>{const n=a.map((e=>'"person-'.concat(e.id,'"'))),o="query {\n    boards(ids: [".concat(te._K.boards.leads,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.deals.last_rep_assigned_date,'", compare_value: [').concat(t,'], operator: between }\n            { column_id: "').concat(te.zu.leads.assginee,'", compare_value: [').concat(n,'], operator: any_of}\n            { column_id: "').concat(te.zu.leads.stage,'", compare_value: [11], operator: any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.leads.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }');return await ne.A.api(o)},Ee=async(e,a,t)=>{var n,o,s,i;const r=a.map((e=>'"person-'.concat(e.id,'"'))),l="query {\n    boards(ids: [".concat(te._K.boards.deals,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.deals.last_rep_assigned_date,'", compare_value: [').concat(t,'], operator: between }\n            { column_id: "').concat(te.zu.deals.assginee,'", compare_value: [').concat(r,'], operator: any_of}\n            { column_id: "').concat(te.zu.deals.stage,'", compare_value: [9], operator: any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.deals.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }'),c=await ne.A.api(l);return null!==c&&void 0!==c&&null!==(n=c.data)&&void 0!==n&&null!==(o=n.boards)&&void 0!==o&&null!==(s=o[0])&&void 0!==s&&null!==(i=s.items_page)&&void 0!==i&&i.items&&(c.data.boards[0].items_page.items=c.data.boards[0].items_page.items.map((e=>(0,le.A)((0,le.A)({},e),{},{isDeal:!0})))),c},Ne=async(e,a,t)=>{const n=a.map((e=>'"person-'.concat(e.id,'"'))),o="query {\n    totalFunds: boards(ids: [".concat(te._K.boards.deals,"]) {\n      items_page(\n      ").concat(e?"":'query_params: {\n        rules: [\n          { column_id: "'.concat(te.zu.deals.funded__date,'", compare_value: [').concat(t,'], operator: between}\n          { column_id: "').concat(te.zu.deals.assginee,'", compare_value: [').concat(n,"], operator: any_of}\n       ]\n       }"),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.deals.assginee,'", "').concat(te.zu.deals.last_rep_assigned_date,'", "').concat(te.zu.deals.funded__date,'"]) {\n            id\n            text\n            value\n          }\n          subitems {\n            id\n            name\n            column_values (ids: ["').concat(te.zu.subItem.status,'", "').concat(te.zu.subItem.funding_amount,'"]) {\n              id\n              text\n              value\n            }\n          }\n        }\n      }\n    }\n  }');return await ne.A.api(o)},De=async(e,a,t,n,o)=>{const s="query {\n    saleActivities: boards(ids: [".concat(o,"]) {\n      items_page(\n      ").concat(e?"":'query_params: {\n        rules: [\n          { column_id: "date__1", compare_value: ['.concat(a,'], operator: between}\n          { column_id: "status", compare_value: [').concat(t,"], operator: any_of}\n       ]\n       }"),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          name\n          column_values(ids: ["person", "status", "date4", "date__1"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }');return await ne.A.api(s)};var ke=t(4414);const{RangePicker:Le}=s.A;const Fe=function(e){let a,t,{withFilter:n}=e;const[o,s]=(0,l.useState)(!1),[c,u]=(0,l.useState)([]),[m,p]=(0,l.useState)([]),[v,g]=(0,l.useState)([]),[f,_]=(0,l.useState)([]),[b,y]=(0,l.useState)([ie()(),ie()()]),h=(0,l.useRef)(),[x,j]=(0,l.useState)([]),[A,w]=(0,l.useState)([]),O=async()=>{const e=await(0,ae.Wd)();if(u(e),n){const a=null===e||void 0===e?void 0:e.map((e=>e.id));_(a)}},S=async function(e,a){s(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]);const t=await(0,ae.iE)(te._K.boards.salesActivities,"status"),n=Object.values(t).reduce(((e,a)=>(e[a.toLowerCase()]=a.toLowerCase(),e)),{}),o=ce.map((e=>e.toLowerCase())),i=(0,re.Ye)(Object.keys(n),o,!0);j(i);const r=Object.keys(t).filter((e=>ce.includes(t[e]))),l=await(async(e,a,t)=>{t.map((e=>'"person-'.concat(e.id,'"')));const n=e.map((e=>'"'.concat(e.format("YYYY-MM-DD"),'"')));let o=null,s=[];o=null;do{var i,r,l,c,d,u,m,p,v;o=await De(o?null===(c=o.data)||void 0===c||null===(d=c.saleActivities[0])||void 0===d||null===(u=d.items_page)||void 0===u?void 0:u.cursor:null,n,a,0,te._K.boards.salesActivities),s=[...s,...(null===(m=((null===(v=o.data)||void 0===v?void 0:v.saleActivities)||[])[0])||void 0===m||null===(p=m.items_page)||void 0===p?void 0:p.items)||[]]}while(null!==(i=((null===(l=o.data)||void 0===l?void 0:l.saleActivities)||[])[0])&&void 0!==i&&null!==(r=i.items_page)&&void 0!==r&&r.cursor);do{var g,f,_,b,y,h,x,j,A;o=await De(o?null===(b=o.data)||void 0===b||null===(y=b.saleActivities[0])||void 0===y||null===(h=y.items_page)||void 0===h?void 0:h.cursor:null,n,a,0,te._K.boards.salesActivities2),s=[...s,...(null===(x=((null===(A=o.data)||void 0===A?void 0:A.saleActivities)||[])[0])||void 0===x||null===(j=x.items_page)||void 0===j?void 0:j.items)||[]]}while(null!==(g=((null===(_=o.data)||void 0===_?void 0:_.saleActivities)||[])[0])&&void 0!==g&&null!==(f=g.items_page)&&void 0!==f&&f.cursor);do{var w,O,S,C,z,E,N,D,k;o=await De(o?null===(C=o.data)||void 0===C||null===(z=C.saleActivities[0])||void 0===z||null===(E=z.items_page)||void 0===E?void 0:E.cursor:null,n,a,0,te._K.boards.salesActivities3),s=[...s,...(null===(N=((null===(k=o.data)||void 0===k?void 0:k.saleActivities)||[])[0])||void 0===N||null===(D=N.items_page)||void 0===D?void 0:D.items)||[]]}while(null!==(w=((null===(S=o.data)||void 0===S?void 0:S.saleActivities)||[])[0])&&void 0!==w&&null!==(O=w.items_page)&&void 0!==O&&O.cursor);return s.reduce(((e,a)=>{var n;const o=null===a||void 0===a||null===(n=a.column_values)||void 0===n?void 0:n.find((e=>"status"===e.id)),s=(0,re.oG)(a.column_values||[],"person"),i=e;if(Oe().isEmpty(s))return i;const r=t.find((e=>s.personsAndTeams[0].id===Number(e.id)));if(!r)return i;const l=o.text.toLowerCase();return i[r.id]?i[r.id][l]?i[r.id][l]+=1:i[r.id]=(0,le.A)((0,le.A)({},i[r.id]),{},{[l]:1}):i[r.id]={[l]:1,person:r},i}),{})})(e,r,a),c=await(0,ae.D5)(e,a),d=await(async(e,a)=>{let t=null,n=[];const o=a.map((e=>'"'.concat(e.format("YYYY-MM-DD"),'"')));do{var s,i,r;t=await Ne(t?((null===(i=t.data)||void 0===i?void 0:i.totalFunds)||[])[0].items_page.cursor:null,e,o),n=[...n,...((null===(r=t.data)||void 0===r?void 0:r.totalFunds)||[])[0].items_page.items]}while(((null===(s=t.data)||void 0===s?void 0:s.totalFunds)||[])[0].items_page.cursor);const l=n.reduce(((a,t)=>{const n=a,o=t.subitems.find((e=>e.column_values.find((e=>e.id===te.zu.subItem.status&&"Selected"===e.text))));if(!o)return n;const s=(0,re.oG)(t.column_values||[],te.zu.deals.assginee);if(Oe().isEmpty(s))return n;const i=e.find((e=>s.personsAndTeams[0].id===Number(e.id)));if(!i)return n;const r="totalfunds",l="fully funded",c=(0,re.oG)(t.column_values||[],te.zu.deals.last_rep_assigned_date),d=(0,re.oG)(t.column_values||[],te.zu.deals.funded__date),u=(0,re.IZ)(o.column_values[1].text),m=(0,re.uS)(null===c||void 0===c?void 0:c.date,null===d||void 0===d?void 0:d.date);return n[i.id]?(n[i.id][r]+=u,n[i.id][l]+=1,n[i.id].totalDaysDifference+=m,n[i.id].totalDeals+=1):n[i.id]={[r]:u,[l]:1,totalDaysDifference:m,totalDeals:1,person:i},n}),{});return Object.keys(l).forEach((e=>{const a=l[e],t=a.totalfunds/a.totalDeals,n=a.totalDaysDifference/a.totalDeals;l[e]=(0,le.A)((0,le.A)({},a),{},{averageFunds:t.toFixed(2),averageDaysDifference:Math.round(n)})})),l})(a,e),u=await(async e=>{let a=null,t=[];do{a=await Se(a?a.data.boards[0].items_page.cursor:null,e),t=[...t,...a.data.boards[0].items_page.items]}while(a.data.boards[0].items_page.cursor);do{a=await Ce(a?a.data.boards[0].items_page.cursor:null,e),t=[...t,...a.data.boards[0].items_page.items]}while(a.data.boards[0].items_page.cursor);return t.reduce(((a,t)=>{const n=(0,re.oG)(t.column_values||[],t.isDeal?te.zu.deals.assginee:te.zu.leads.assginee),o=a;if(Oe().isEmpty(n))return o;const s=e.find((e=>n.personsAndTeams[0].id===Number(e.id)));return s?(o[s.id]?o[s.id]+=1:o[s.id]=1,o):o}),{})})(a),m=await(async(e,a)=>{const t=a.map((e=>'"'.concat(e.format("YYYY-MM-DD"),'"')));let n=null,o=[];do{n=await ze(n?n.data.boards[0].items_page.cursor:null,e,t),o=[...o,...n.data.boards[0].items_page.items]}while(n.data.boards[0].items_page.cursor);do{n=await Ee(n?n.data.boards[0].items_page.cursor:null,e,t),o=[...o,...n.data.boards[0].items_page.items]}while(n.data.boards[0].items_page.cursor);return o.reduce(((a,t)=>{const n=(0,re.oG)(t.column_values||[],t.isDeal?te.zu.deals.assginee:te.zu.leads.assginee),o=a;if(Oe().isEmpty(n))return o;const s=e.find((e=>n.personsAndTeams[0].id===Number(e.id)));return s?(o[s.id]?o[s.id]+=1:o[s.id]=1,o):o}),{})})(a,e),p=((e,a,t,n,o,s)=>{const i={};return Object.keys(o).forEach((e=>{i[e]=(0,le.A)({},o[e])})),Object.keys(e).forEach((a=>{var t;i[a]||(i[a]={person:s.find((e=>e.id===a))}),i[a].leadsAssigned=(null===(t=e[a])||void 0===t?void 0:t.count)||0})),Object.keys(t).forEach((e=>{i[e]||(i[e]={person:s.find((a=>a.id===e))}),i[e].allLeadsAssigned=t[e]||0})),Object.keys(n).forEach((e=>{i[e]||(i[e]={person:s.find((a=>a.id===e))}),i[e].allLeadsDisqualified=n[e]||0})),Object.keys(a).forEach((e=>{i[e]||(i[e]={person:{id:e}}),i[e]=(0,le.A)((0,le.A)({},i[e]),a[e])})),Object.keys(i).forEach((e=>{const a=i[e],t=a["offer received back"]||0,n=a["fully funded"]||0;a.conversionRatio=t>0?"".concat((n/t*100).toFixed(2),"%"):"0%"})),i})(c,d,u,m,l,a);w(p),s(!1)};(0,l.useEffect)((()=>{O(),h.current=[ie()(),ie()()],n&&(async()=>{const e=await(0,ae.Ym)(),a=null===e||void 0===e?void 0:e.map((e=>({value:e.id,label:e.name})));p(e),g(a)})()}),[]),(0,l.useEffect)((()=>{0!==c.length&&S(b,c)}),[c,b]);const C=e=>{let{data:a}=e;a.itemIds.includes(Number(te._K.leaderEmployeeItemId))&&(t&&clearTimeout(t),t=setTimeout((()=>{O()}),3e3))};return(0,l.useEffect)((()=>n?null:(a=ne.A.listen("events",C),()=>{a&&a()})),[]),(0,l.useEffect)((()=>{if(n)return null;const e=setInterval((()=>{h.current,S(b,c,!1)}),1e3*te._K.performanceRefetchTime);return()=>{e&&clearInterval(e)}}),[]),(0,ke.jsxs)(i.A,{vertical:!0,flex:1,children:[(0,ke.jsx)(r.A,{tip:"Loading...",spinning:o,fullscreen:!0}),n?(0,ke.jsxs)(i.A,{className:ye,align:"center",children:[(0,ke.jsx)(i.A,{children:"Filters: "}),(0,ke.jsx)(i.A,{className:xe,children:(0,ke.jsx)(oe.A,{classnames:he,options:v,onChange:e=>{const a=m.filter((a=>e.includes(a.id)));u(a),_(e)},mode:"multiple",maxTagCount:3,placeholder:"Select Users",value:f})}),(0,ke.jsx)(i.A,{className:xe,children:(0,ke.jsx)(Le,{value:b,placeholder:"Select Date Range",onChange:e=>{y(e),h.current=e},allowClear:!1,maxDate:ie()(),format:"MM-DD-YYYY"})})]}):null,(0,ke.jsxs)(i.A,{vertical:!0,className:me,children:[(0,ke.jsxs)(i.A,{className:pe,align:"center",children:[(0,ke.jsx)(i.A,{className:ve,children:"Performance Leaderboard"}),(0,ke.jsx)(i.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,ke.jsx)(i.A,{children:de["total leads assigned"]})}),(0,ke.jsx)(i.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,ke.jsx)(i.A,{children:de["leads assigned"]})}),(0,ke.jsx)(i.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,ke.jsx)(i.A,{children:de["disqualified leads"]})}),x.map((e=>(0,ke.jsx)(i.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,ke.jsx)(i.A,{children:de[e]})}))),(0,ke.jsx)(i.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,ke.jsx)(i.A,{children:de["conversion ratio"]})}),(0,ke.jsx)(i.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,ke.jsx)(i.A,{children:de["avg deal size"]})}),(0,ke.jsx)(i.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,ke.jsx)(i.A,{children:de["avg time to fund"]})})]}),c.map(((e,a)=>(0,ke.jsxs)(i.A,{className:d()(be,{[je]:a%2}),children:[(0,ke.jsxs)(i.A,{className:ge,align:"center",children:[(0,ke.jsx)(i.A,{style:{marginRight:10},children:e.photo_thumb?(0,ke.jsx)(ee,{src:e.photo_thumb}):(0,ke.jsx)(ee,{children:e.name[0]})}),(0,ke.jsx)(i.A,{children:e.name.split(" ")[0]})]}),(0,ke.jsx)(i.A,{className:_e,justify:"center",align:"center",children:(A[e.id]||{}).allLeadsAssigned||" "}),(0,ke.jsx)(i.A,{className:_e,justify:"center",align:"center",children:(A[e.id]||{}).leadsAssigned||" "}),(0,ke.jsx)(i.A,{className:_e,justify:"center",align:"center",children:(A[e.id]||{}).allLeadsDisqualified||" "}),x.map((a=>{const t=ue[a],n="leads assigned"===t?(A[e.id]||{}).leadsAssigned:(A[e.id]||{})[t],o=(A[e.id]||{})[a],s=n&&o?(o/n*100).toFixed(0):"";return(0,ke.jsxs)(i.A,{className:_e,justify:"center",align:"center",vertical:!0,children:[(0,ke.jsx)(i.A,{children:(A[e.id]||{})[a]||" "}),(0,ke.jsx)(i.A,{className:Ae,children:s?"".concat(s,"%"):""})]})})),(0,ke.jsx)(i.A,{className:_e,justify:"center",align:"center",children:(A[e.id]||{}).conversionRatio||" "}),(0,ke.jsxs)(i.A,{className:_e,justify:"center",align:"center",children:["$",(A[e.id]||{}).averageFunds||"0"]}),(0,ke.jsx)(i.A,{className:_e,justify:"center",align:"center",children:(A[e.id]||{}).averageDaysDifference||"0"})]})))]})]})};const Be=function(e){let{withFilter:a}=e;return(0,ke.jsx)(n.Ay,{theme:{token:{fontFamily:"Poppins"},components:{Layout:{bodyBg:"#E1EFF2",headerBg:"#E1EFF2"}}},children:(0,ke.jsx)(o.A,{style:{padding:"0 8px 24px"},children:(0,ke.jsx)(Fe,{withFilter:a})})})}}}]);