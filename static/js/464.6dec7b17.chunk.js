"use strict";(self.webpackChunkbroker_dashboard=self.webpackChunkbroker_dashboard||[]).push([[464],{9464:(e,a,n)=>{n.r(a),n.d(a,{default:()=>Be});var t=n(5465),s=n(718),o=n(9379),i=n(2746),r=n(4064),l=n(2612),c=n(9950),d=n(8738),u=n.n(d),m=n(7090),p=n(1929),g=n(6191),v=n(5741),f=n(5656),y=n(9415),h=n(183);const _=c.createContext({});var b=n(7409),x=n(5343),A=n(2672),j=n(1874);const w=e=>{const{antCls:a,componentCls:n,iconCls:t,avatarBg:s,avatarColor:o,containerSize:i,containerSizeLG:r,containerSizeSM:l,textFontSize:c,textFontSizeLG:d,textFontSizeSM:u,borderRadius:m,borderRadiusLG:p,borderRadiusSM:g,lineWidth:v,lineType:f}=e,y=(e,a,s)=>({width:e,height:e,borderRadius:"50%",["&".concat(n,"-square")]:{borderRadius:s},["&".concat(n,"-icon")]:{fontSize:a,["> ".concat(t)]:{margin:0}}});return{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,x.dF)(e)),{position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:o,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:s,border:"".concat((0,b.zA)(v)," ").concat(f," transparent"),"&-image":{background:"transparent"},["".concat(a,"-image-img")]:{display:"block"}}),y(i,c,m)),{"&-lg":Object.assign({},y(r,d,p)),"&-sm":Object.assign({},y(l,u,g)),"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}})}},O=e=>{const{componentCls:a,groupBorderColor:n,groupOverlapping:t,groupSpace:s}=e;return{["".concat(a,"-group")]:{display:"inline-flex",["".concat(a)]:{borderColor:n},"> *:not(:first-child)":{marginInlineStart:t}},["".concat(a,"-group-popover")]:{["".concat(a," + ").concat(a)]:{marginInlineStart:s}}}},C=(0,A.OF)("Avatar",(e=>{const{colorTextLightSolid:a,colorTextPlaceholder:n}=e,t=(0,j.h1)(e,{avatarBg:n,avatarColor:a});return[w(t),O(t)]}),(e=>{const{controlHeight:a,controlHeightLG:n,controlHeightSM:t,fontSize:s,fontSizeLG:o,fontSizeXL:i,fontSizeHeading3:r,marginXS:l,marginXXS:c,colorBorderBg:d}=e;return{containerSize:a,containerSizeLG:n,containerSizeSM:t,textFontSize:Math.round((o+i)/2),textFontSizeLG:r,textFontSizeSM:s,groupSpace:c,groupOverlapping:-l,groupBorderColor:d}}));var S=function(e,a){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.indexOf(t)<0&&(n[t]=e[t]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(t=Object.getOwnPropertySymbols(e);s<t.length;s++)a.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(e,t[s])&&(n[t[s]]=e[t[s]])}return n};const z=(e,a)=>{const[n,t]=c.useState(1),[s,o]=c.useState(!1),[i,r]=c.useState(!0),l=c.useRef(null),d=c.useRef(null),b=(0,p.K4)(a,l),{getPrefixCls:x,avatar:A}=c.useContext(v.QO),j=c.useContext(_),w=()=>{if(!d.current||!l.current)return;const a=d.current.offsetWidth,n=l.current.offsetWidth;if(0!==a&&0!==n){const{gap:s=4}=e;2*s<n&&t(n-2*s<a?(n-2*s)/a:1)}};c.useEffect((()=>{o(!0)}),[]),c.useEffect((()=>{r(!0),t(1)}),[e.src]),c.useEffect(w,[e.gap]);const O=()=>{const{onError:a}=e;!1!==(null===a||void 0===a?void 0:a())&&r(!1)},{prefixCls:z,shape:N,size:D,src:E,srcSet:L,icon:F,className:k,rootClassName:B,alt:R,draggable:P,children:q,crossOrigin:M}=e,T=S(e,["prefixCls","shape","size","src","srcSet","icon","className","rootClassName","alt","draggable","children","crossOrigin"]),I=(0,y.A)((e=>{var a,n;return null!==(n=null!==(a=null!==D&&void 0!==D?D:null===j||void 0===j?void 0:j.size)&&void 0!==a?a:e)&&void 0!==n?n:"default"})),G=Object.keys("object"===typeof I&&I||{}).some((e=>["xs","sm","md","lg","xl","xxl"].includes(e))),W=(0,h.A)(G),Y=c.useMemo((()=>{if("object"!==typeof I)return{};const e=g.ye.find((e=>W[e])),a=I[e];return a?{width:a,height:a,fontSize:a&&(F||q)?a/2:18}:{}}),[W,I]);const K=x("avatar",z),H=(0,f.A)(K),[V,X,Q]=C(K,H),Z=u()({["".concat(K,"-lg")]:"large"===I,["".concat(K,"-sm")]:"small"===I}),J=c.isValidElement(E),U=N||(null===j||void 0===j?void 0:j.shape)||"circle",$=u()(K,Z,null===A||void 0===A?void 0:A.className,"".concat(K,"-").concat(U),{["".concat(K,"-image")]:J||E&&i,["".concat(K,"-icon")]:!!F},Q,H,k,B,X),ee="number"===typeof I?{width:I,height:I,fontSize:F?I/2:18}:{};let ae;if("string"===typeof E&&i)ae=c.createElement("img",{src:E,draggable:P,srcSet:L,onError:O,alt:R,crossOrigin:M});else if(J)ae=E;else if(F)ae=F;else if(s||1!==n){const e="scale(".concat(n,")"),a={msTransform:e,WebkitTransform:e,transform:e};ae=c.createElement(m.A,{onResize:w},c.createElement("span",{className:"".concat(K,"-string"),ref:d,style:Object.assign({},a)},q))}else ae=c.createElement("span",{className:"".concat(K,"-string"),style:{opacity:0},ref:d},q);return delete T.onError,delete T.gap,V(c.createElement("span",Object.assign({},T,{style:Object.assign(Object.assign(Object.assign(Object.assign({},ee),Y),null===A||void 0===A?void 0:A.style),T.style),className:$,ref:b}),ae))};const N=c.forwardRef(z);var D=n(604),E=n(9156),L=n(1207),F=n(1478);const k=e=>e?"function"===typeof e?e():e:null;var B=n(9437),R=n(6680),P=n(9888),q=n(8691),M=n(6871),T=n(1201),I=n(8704);const G=e=>{const{componentCls:a,popoverColor:n,titleMinWidth:t,fontWeightStrong:s,innerPadding:o,boxShadowSecondary:i,colorTextHeading:r,borderRadiusLG:l,zIndexPopup:c,titleMarginBottom:d,colorBgElevated:u,popoverBg:m,titleBorderBottom:p,innerContentPadding:g,titlePadding:v}=e;return[{[a]:Object.assign(Object.assign({},(0,x.dF)(e)),{position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:c,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","--antd-arrow-background-color":u,width:"max-content",maxWidth:"100vw","&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},["".concat(a,"-content")]:{position:"relative"},["".concat(a,"-inner")]:{backgroundColor:m,backgroundClip:"padding-box",borderRadius:l,boxShadow:i,padding:o},["".concat(a,"-title")]:{minWidth:t,marginBottom:d,color:r,fontWeight:s,borderBottom:p,padding:v},["".concat(a,"-inner-content")]:{color:n,padding:g}})},(0,M.Ay)(e,"var(--antd-arrow-background-color)"),{["".concat(a,"-pure")]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow,display:"inline-block",["".concat(a,"-content")]:{display:"inline-block"}}}]},W=e=>{const{componentCls:a}=e;return{[a]:I.s.map((n=>{const t=e["".concat(n,"6")];return{["&".concat(a,"-").concat(n)]:{"--antd-arrow-background-color":t,["".concat(a,"-inner")]:{backgroundColor:t},["".concat(a,"-arrow")]:{background:"transparent"}}}}))}},Y=(0,A.OF)("Popover",(e=>{const{colorBgElevated:a,colorText:n}=e,t=(0,j.h1)(e,{popoverBg:a,popoverColor:n});return[G(t),W(t),(0,q.aB)(t,"zoom-big")]}),(e=>{const{lineWidth:a,controlHeight:n,fontHeight:t,padding:s,wireframe:o,zIndexPopupBase:i,borderRadiusLG:r,marginXS:l,lineType:c,colorSplit:d,paddingSM:u}=e,m=n-t,p=m/2,g=m/2-a,v=s;return Object.assign(Object.assign(Object.assign({titleMinWidth:177,zIndexPopup:i+30},(0,T.n)(e)),(0,M.Ke)({contentRadius:r,limitVerticalRadius:!0})),{innerPadding:o?0:12,titleMarginBottom:o?0:l,titlePadding:o?"".concat(p,"px ").concat(v,"px ").concat(g,"px"):0,titleBorderBottom:o?"".concat(a,"px ").concat(c," ").concat(d):"none",innerContentPadding:o?"".concat(u,"px ").concat(v,"px"):0})}),{resetStyle:!1,deprecatedTokens:[["width","titleMinWidth"],["minWidth","titleMinWidth"]]});var K=function(e,a){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.indexOf(t)<0&&(n[t]=e[t]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(t=Object.getOwnPropertySymbols(e);s<t.length;s++)a.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(e,t[s])&&(n[t[s]]=e[t[s]])}return n};const H=e=>{const{hashId:a,prefixCls:n,className:t,style:s,placement:o="top",title:i,content:r,children:l}=e;return c.createElement("div",{className:u()(a,n,"".concat(n,"-pure"),"".concat(n,"-placement-").concat(o),t),style:s},c.createElement("div",{className:"".concat(n,"-arrow")}),c.createElement(P.z,Object.assign({},e,{className:a,prefixCls:n}),l||((e,a,n)=>a||n?c.createElement(c.Fragment,null,a&&c.createElement("div",{className:"".concat(e,"-title")},k(a)),c.createElement("div",{className:"".concat(e,"-inner-content")},k(n))):null)(n,i,r)))},V=e=>{const{prefixCls:a,className:n}=e,t=K(e,["prefixCls","className"]),{getPrefixCls:s}=c.useContext(v.QO),o=s("popover",a),[i,r,l]=Y(o);return i(c.createElement(H,Object.assign({},t,{prefixCls:o,hashId:r,className:u()(n,l)})))};var X=function(e,a){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.indexOf(t)<0&&(n[t]=e[t]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(t=Object.getOwnPropertySymbols(e);s<t.length;s++)a.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(e,t[s])&&(n[t[s]]=e[t[s]])}return n};const Q=e=>{let{title:a,content:n,prefixCls:t}=e;return c.createElement(c.Fragment,null,a&&c.createElement("div",{className:"".concat(t,"-title")},k(a)),c.createElement("div",{className:"".concat(t,"-inner-content")},k(n)))},Z=c.forwardRef(((e,a)=>{var n,t;const{prefixCls:s,title:o,content:i,overlayClassName:r,placement:l="top",trigger:d="hover",children:m,mouseEnterDelay:p=.1,mouseLeaveDelay:g=.1,onOpenChange:f,overlayStyle:y={}}=e,h=X(e,["prefixCls","title","content","overlayClassName","placement","trigger","children","mouseEnterDelay","mouseLeaveDelay","onOpenChange","overlayStyle"]),{getPrefixCls:_}=c.useContext(v.QO),b=_("popover",s),[x,A,j]=Y(b),w=_(),O=u()(r,A,j),[C,S]=(0,L.A)(!1,{value:null!==(n=e.open)&&void 0!==n?n:e.visible,defaultValue:null!==(t=e.defaultOpen)&&void 0!==t?t:e.defaultVisible}),z=(e,a)=>{S(e,!0),null===f||void 0===f||f(e,a)};return x(c.createElement(R.A,Object.assign({placement:l,trigger:d,mouseEnterDelay:p,mouseLeaveDelay:g,overlayStyle:y},h,{prefixCls:b,overlayClassName:O,ref:a,open:C,onOpenChange:e=>{z(e)},overlay:o||i?c.createElement(Q,{prefixCls:b,title:o,content:i}):null,transitionName:(0,B.b)(w,"zoom-big",h.transitionName),"data-popover-inject":!0}),(0,E.Ob)(m,{onKeyDown:e=>{var a,n;c.isValidElement(m)&&(null===(n=null===m||void 0===m?void 0:(a=m.props).onKeyDown)||void 0===n||n.call(a,e)),(e=>{e.keyCode===F.A.ESC&&z(!1,e)})(e)}})))}));Z._InternalPanelDoNotUseOrYouWillBeFired=V;const J=Z,U=e=>{const{size:a,shape:n}=c.useContext(_),t=c.useMemo((()=>({size:e.size||a,shape:e.shape||n})),[e.size,e.shape,a,n]);return c.createElement(_.Provider,{value:t},e.children)},$=e=>{const{getPrefixCls:a,direction:n}=c.useContext(v.QO),{prefixCls:t,className:s,rootClassName:o,style:i,maxCount:r,maxStyle:l,size:d,shape:m,maxPopoverPlacement:p="top",maxPopoverTrigger:g="hover",children:y}=e,h=a("avatar",t),_="".concat(h,"-group"),b=(0,f.A)(h),[x,A,j]=C(h,b),w=u()(_,{["".concat(_,"-rtl")]:"rtl"===n},j,b,s,o,A),O=(0,D.A)(y).map(((e,a)=>(0,E.Ob)(e,{key:"avatar-key-".concat(a)}))),S=O.length;if(r&&r<S){const e=O.slice(0,r),a=O.slice(r,S);return e.push(c.createElement(J,{key:"avatar-popover-key",content:a,trigger:g,placement:p,overlayClassName:"".concat(_,"-popover"),destroyTooltipOnHide:!0},c.createElement(N,{style:l},"+".concat(S-r)))),x(c.createElement(U,{shape:m,size:d},c.createElement("div",{className:w,style:i},e)))}return x(c.createElement(U,{shape:m,size:d},c.createElement("div",{className:w,style:i},O)))},ee=N;ee.Group=$;const ae=ee;var ne=n(4051),te=n(326),se=n(859),oe=n(6541),ie=n(4159),re=n.n(ie),le=n(6338);const ce=["Follow up call","Deal Submitted","Offer Received Back","Fully funded"],de={"total leads assigned":"# of Active Leads Assigned","leads assigned":"# of Leads Assigned","disqualified leads":"# of Leads Disqualified","follow up call":"Attempted Calls","deal submitted":"Deal Submitted","offer received back":"Approvals","contract out":"Contract out","contract signed":"Contract Signed","fully funded":"Deals Funded","client rejected":"Client Rejected",declined:"Declined",disqualified:"Disqualified","conversion ratio":"Conversion Ratio (Funded/Approvals)","avg deal size":"Avg Funded Deal Size","avg time to fund":"Avg Time from Application to Funded"},ue={"deal submitted":"leads assigned","offer received back":"deal submitted","fully funded":"offer received back"},me="LeaderBoards_table__u3STH",pe="LeaderBoards_headerRow__Bv7Lq",ge="LeaderBoards_headerColumnTitle__BbeRM",ve="LeaderBoards_dataColumnTitle__bj7wK",fe="LeaderBoards_headerColumnPerson__JzV2F",ye="LeaderBoards_dataColumnPerson__V8O69",he="LeaderBoards_dataRow__H-WEt",_e="LeaderBoards_filterbar__nKucZ",be="LeaderBoards_usersList__4ySG9",xe="LeaderBoards_filterField__14bMZ",Ae="LeaderBoards_alternateColor__iGVHE",je="LeaderBoards_percentage__J7lGV";var we=n(1397),Oe=n.n(we);const Ce=async(e,a)=>{const n=a.map((e=>'"person-'.concat(e.id,'"'))),t="query {\n    boards(ids: [".concat(te._K.boards.leads,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.leads.assginee,'", compare_value: [').concat(n,'], operator: any_of}\n            { column_id: "').concat(te.zu.leads.stage,'", compare_value: [11,14], operator: not_any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.leads.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }');return await se.A.api(t)},Se=async(e,a)=>{var n,t,s,i;const r=a.map((e=>'"person-'.concat(e.id,'"'))),l="query {\n    boards(ids: [".concat(te._K.boards.deals,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.deals.assginee,'", compare_value: [').concat(r,'], operator: any_of}\n            { column_id: "').concat(te.zu.deals.stage,'", compare_value: [1,5,6,8,9,10,11,14], operator: not_any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.deals.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }'),c=await se.A.api(l);return null!==c&&void 0!==c&&null!==(n=c.data)&&void 0!==n&&null!==(t=n.boards)&&void 0!==t&&null!==(s=t[0])&&void 0!==s&&null!==(i=s.items_page)&&void 0!==i&&i.items&&(c.data.boards[0].items_page.items=c.data.boards[0].items_page.items.map((e=>(0,o.A)((0,o.A)({},e),{},{isDeal:!0})))),c},ze=async(e,a,n)=>{const t=a.map((e=>'"person-'.concat(e.id,'"'))),s="query {\n    boards(ids: [".concat(te._K.boards.leads,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.deals.last_rep_assigned_date,'", compare_value: [').concat(n,'], operator: between }\n            { column_id: "').concat(te.zu.leads.assginee,'", compare_value: [').concat(t,'], operator: any_of}\n            { column_id: "').concat(te.zu.leads.stage,'", compare_value: [11], operator: any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.leads.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }');return await se.A.api(s)},Ne=async(e,a,n)=>{var t,s,i,r;const l=a.map((e=>'"person-'.concat(e.id,'"'))),c="query {\n    boards(ids: [".concat(te._K.boards.deals,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.deals.last_rep_assigned_date,'", compare_value: [').concat(n,'], operator: between }\n            { column_id: "').concat(te.zu.deals.assginee,'", compare_value: [').concat(l,'], operator: any_of}\n            { column_id: "').concat(te.zu.deals.stage,'", compare_value: [9], operator: any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.deals.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }'),d=await se.A.api(c);return null!==d&&void 0!==d&&null!==(t=d.data)&&void 0!==t&&null!==(s=t.boards)&&void 0!==s&&null!==(i=s[0])&&void 0!==i&&null!==(r=i.items_page)&&void 0!==r&&r.items&&(d.data.boards[0].items_page.items=d.data.boards[0].items_page.items.map((e=>(0,o.A)((0,o.A)({},e),{},{isDeal:!0})))),d},De=async(e,a,n)=>{const t=a.map((e=>'"person-'.concat(e.id,'"'))),s="query {\n    totalFunds: boards(ids: [".concat(te._K.boards.deals,"]) {\n      items_page(\n      ").concat(e?"":'query_params: {\n        rules: [\n          { column_id: "'.concat(te.zu.deals.funded__date,'", compare_value: [').concat(n,'], operator: between}\n          { column_id: "').concat(te.zu.deals.assginee,'", compare_value: [').concat(t,"], operator: any_of}\n       ]\n       }"),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.deals.assginee,'", "').concat(te.zu.deals.last_rep_assigned_date,'", "').concat(te.zu.deals.funded__date,'"]) {\n            id\n            text\n            value\n          }\n          subitems {\n            id\n            name\n            column_values (ids: ["').concat(te.zu.subItem.status,'", "').concat(te.zu.subItem.funding_amount,'"]) {\n              id\n              text\n              value\n            }\n          }\n        }\n      }\n    }\n  }');return await se.A.api(s)},Ee=async(e,a,n,t,s)=>{const o="query {\n    saleActivities: boards(ids: [".concat(s,"]) {\n      items_page(\n      ").concat(e?"":'query_params: {\n        rules: [\n          { column_id: "date__1", compare_value: ['.concat(a,'], operator: between}\n          { column_id: "status", compare_value: [').concat(n,"], operator: any_of}\n       ]\n       }"),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          name\n          column_values(ids: ["person", "status", "date4", "date__1"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }');return await se.A.api(o)};var Le=n(4414);const{RangePicker:Fe}=i.A;const ke=function(e){let a,n,{withFilter:t}=e;const[s,i]=(0,c.useState)(!1),[d,m]=(0,c.useState)([]),[p,g]=(0,c.useState)([]),[v,f]=(0,c.useState)([]),[y,h]=(0,c.useState)([]),[_,b]=(0,c.useState)([re()(),re()()]),x=(0,c.useRef)(),[A,j]=(0,c.useState)([]),[w,O]=(0,c.useState)([]),[C,S]=(0,c.useState)({}),z=async()=>{const e=await(0,ne.Wd)();if(m(e),t){const a=null===e||void 0===e?void 0:e.map((e=>e.id));h(a)}},N=async function(e,a){i(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]);const n=await(0,ne.iE)(te._K.boards.salesActivities,"status"),t=Object.values(n).reduce(((e,a)=>(e[a.toLowerCase()]=a.toLowerCase(),e)),{}),s=ce.map((e=>e.toLowerCase())),r=(0,le.Ye)(Object.keys(t),s,!0);j(r);const l=Object.keys(n).filter((e=>ce.includes(n[e]))),c=await(async(e,a,n)=>{n.map((e=>'"person-'.concat(e.id,'"')));const t=e.map((e=>'"'.concat(e.format("YYYY-MM-DD"),'"')));let s=null,i=[];s=null;do{var r,l,c,d,u,m,p,g,v;s=await Ee(s?null===(d=s.data)||void 0===d||null===(u=d.saleActivities[0])||void 0===u||null===(m=u.items_page)||void 0===m?void 0:m.cursor:null,t,a,0,te._K.boards.salesActivities),i=[...i,...(null===(p=((null===(v=s.data)||void 0===v?void 0:v.saleActivities)||[])[0])||void 0===p||null===(g=p.items_page)||void 0===g?void 0:g.items)||[]]}while(null!==(r=((null===(c=s.data)||void 0===c?void 0:c.saleActivities)||[])[0])&&void 0!==r&&null!==(l=r.items_page)&&void 0!==l&&l.cursor);do{var f,y,h,_,b,x,A,j,w;s=await Ee(s?null===(_=s.data)||void 0===_||null===(b=_.saleActivities[0])||void 0===b||null===(x=b.items_page)||void 0===x?void 0:x.cursor:null,t,a,0,te._K.boards.salesActivities2),i=[...i,...(null===(A=((null===(w=s.data)||void 0===w?void 0:w.saleActivities)||[])[0])||void 0===A||null===(j=A.items_page)||void 0===j?void 0:j.items)||[]]}while(null!==(f=((null===(h=s.data)||void 0===h?void 0:h.saleActivities)||[])[0])&&void 0!==f&&null!==(y=f.items_page)&&void 0!==y&&y.cursor);do{var O,C,S,z,N,D,E,L,F;s=await Ee(s?null===(z=s.data)||void 0===z||null===(N=z.saleActivities[0])||void 0===N||null===(D=N.items_page)||void 0===D?void 0:D.cursor:null,t,a,0,te._K.boards.salesActivities3),i=[...i,...(null===(E=((null===(F=s.data)||void 0===F?void 0:F.saleActivities)||[])[0])||void 0===E||null===(L=E.items_page)||void 0===L?void 0:L.items)||[]]}while(null!==(O=((null===(S=s.data)||void 0===S?void 0:S.saleActivities)||[])[0])&&void 0!==O&&null!==(C=O.items_page)&&void 0!==C&&C.cursor);return i.reduce(((e,a)=>{var t;const s=null===a||void 0===a||null===(t=a.column_values)||void 0===t?void 0:t.find((e=>"status"===e.id)),i=(0,le.oG)(a.column_values||[],"person"),r=e;if(Oe().isEmpty(i))return r;const l=n.find((e=>i.personsAndTeams[0].id===Number(e.id)));if(!l)return r;const c=s.text.toLowerCase();return r[l.id]?r[l.id][c]?r[l.id][c]+=1:r[l.id]=(0,o.A)((0,o.A)({},r[l.id]),{},{[c]:1}):r[l.id]={[c]:1,person:l},r}),{})})(e,l,a),d=await(0,ne.D5)(e,a),u=await(async(e,a)=>{let n=null,t=[];const s=a.map((e=>'"'.concat(e.format("YYYY-MM-DD"),'"')));do{var i,r,l;n=await De(n?((null===(r=n.data)||void 0===r?void 0:r.totalFunds)||[])[0].items_page.cursor:null,e,s),t=[...t,...((null===(l=n.data)||void 0===l?void 0:l.totalFunds)||[])[0].items_page.items]}while(((null===(i=n.data)||void 0===i?void 0:i.totalFunds)||[])[0].items_page.cursor);const c=t.reduce(((a,n)=>{const t=a,s=n.subitems.find((e=>e.column_values.find((e=>e.id===te.zu.subItem.status&&"Selected"===e.text))));if(!s)return t;const o=(0,le.oG)(n.column_values||[],te.zu.deals.assginee);if(Oe().isEmpty(o))return t;const i=e.find((e=>o.personsAndTeams[0].id===Number(e.id)));if(!i)return t;const r="totalfunds",l="fully funded",c=(0,le.oG)(n.column_values||[],te.zu.deals.last_rep_assigned_date),d=(0,le.oG)(n.column_values||[],te.zu.deals.funded__date),u=(0,le.IZ)(s.column_values[1].text),m=(0,le.uS)(null===c||void 0===c?void 0:c.date,null===d||void 0===d?void 0:d.date);return t[i.id]?(t[i.id][r]+=u,t[i.id][l]+=1,t[i.id].totalDaysDifference+=m,t[i.id].totalDeals+=1):t[i.id]={[r]:u,[l]:1,totalDaysDifference:m,totalDeals:1,person:i},t}),{});return Object.keys(c).forEach((e=>{const a=c[e],n=a.totalfunds/a.totalDeals,t=a.totalDaysDifference/a.totalDeals;c[e]=(0,o.A)((0,o.A)({},a),{},{averageFunds:n.toFixed(2),averageDaysDifference:Math.round(t)})})),c})(a,e),m=await(async e=>{let a=null,n=[];do{a=await Ce(a?a.data.boards[0].items_page.cursor:null,e),n=[...n,...a.data.boards[0].items_page.items]}while(a.data.boards[0].items_page.cursor);do{a=await Se(a?a.data.boards[0].items_page.cursor:null,e),n=[...n,...a.data.boards[0].items_page.items]}while(a.data.boards[0].items_page.cursor);return n.reduce(((a,n)=>{const t=(0,le.oG)(n.column_values||[],n.isDeal?te.zu.deals.assginee:te.zu.leads.assginee),s=a;if(Oe().isEmpty(t))return s;const o=e.find((e=>t.personsAndTeams[0].id===Number(e.id)));return o?(s[o.id]?s[o.id]+=1:s[o.id]=1,s):s}),{})})(a),p=await(async(e,a)=>{const n=a.map((e=>'"'.concat(e.format("YYYY-MM-DD"),'"')));let t=null,s=[];do{t=await ze(t?t.data.boards[0].items_page.cursor:null,e,n),s=[...s,...t.data.boards[0].items_page.items]}while(t.data.boards[0].items_page.cursor);do{t=await Ne(t?t.data.boards[0].items_page.cursor:null,e,n),s=[...s,...t.data.boards[0].items_page.items]}while(t.data.boards[0].items_page.cursor);return s.reduce(((a,n)=>{const t=(0,le.oG)(n.column_values||[],n.isDeal?te.zu.deals.assginee:te.zu.leads.assginee),s=a;if(Oe().isEmpty(t))return s;const o=e.find((e=>t.personsAndTeams[0].id===Number(e.id)));return o?(s[o.id]?s[o.id]+=1:s[o.id]=1,s):s}),{})})(a,e),g=((e,a,n,t,s,i)=>{const r={};return Object.keys(s).forEach((e=>{r[e]=(0,o.A)({},s[e])})),Object.keys(e).forEach((a=>{var n;r[a]||(r[a]={person:i.find((e=>e.id===a))}),r[a].leadsAssigned=(null===(n=e[a])||void 0===n?void 0:n.count)||0})),Object.keys(n).forEach((e=>{r[e]||(r[e]={person:i.find((a=>a.id===e))}),r[e].allLeadsAssigned=n[e]||0})),Object.keys(t).forEach((e=>{r[e]||(r[e]={person:i.find((a=>a.id===e))}),r[e].allLeadsDisqualified=t[e]||0})),Object.keys(a).forEach((e=>{r[e]||(r[e]={person:{id:e}}),r[e]=(0,o.A)((0,o.A)({},r[e]),a[e])})),Object.keys(r).forEach((e=>{const a=r[e],n=a["offer received back"]||0,t=a["fully funded"]||0;a.conversionRatio=n>0?(t/n*100).toFixed(2):0})),r})(d,u,m,p,c,a);O(g),i(!1)};(0,c.useEffect)((()=>{z(),x.current=[re()(),re()()],t&&(async()=>{const e=await(0,ne.Ym)(),a=null===e||void 0===e?void 0:e.map((e=>({value:e.id,label:e.name})));g(e),f(a)})()}),[]),(0,c.useEffect)((()=>{0!==d.length&&N(_,d)}),[d,_]);const D=e=>{let{data:a}=e;a.itemIds.includes(Number(te._K.leaderEmployeeItemId))&&(n&&clearTimeout(n),n=setTimeout((()=>{z()}),3e3))};return(0,c.useEffect)((()=>t?null:(a=se.A.listen("events",D),()=>{a&&a()})),[]),(0,c.useEffect)((()=>{if(t)return null;const e=setInterval((()=>{x.current,N(_,d,!1)}),1e3*te._K.performanceRefetchTime);return()=>{e&&clearInterval(e)}}),[]),(0,c.useEffect)((()=>{0!==d.length?(()=>{const e=d.reduce(((e,a)=>{const n=w[a.id]||{};e.allLeadsAssigned+=n.allLeadsAssigned||0,e.leadsAssigned+=n.leadsAssigned||0,e.allLeadsDisqualified+=n.allLeadsDisqualified||0;for(let t=0;t<A.length;t+=1){const a=A[t];e[a]||(e[a]=0),e[a]+=n[a]?Number(n[a]):0}return e.conversionRatio+=Number(n.conversionRatio)||0,e.averageFunds+=Number(n.averageFunds)||0,e.averageDaysDifference+=n.averageDaysDifference||0,e}),{allLeadsAssigned:0,leadsAssigned:0,allLeadsDisqualified:0,conversionRatio:0,averageFunds:0,averageDaysDifference:0}),a=d.length,n=(0,o.A)((0,o.A)({},e),{},{allLeadsAssigned:e.allLeadsAssigned,leadsAssigned:e.leadsAssigned,allLeadsDisqualified:e.allLeadsDisqualified,conversionRatio:e.conversionRatio?(e.conversionRatio/a).toFixed(2):0,averageFunds:(e.averageFunds/a).toFixed(2),averageDaysDifference:(e.averageDaysDifference/a).toFixed(2)});S(n)})():S({})}),[d,w]),(0,Le.jsxs)(r.A,{vertical:!0,flex:1,children:[(0,Le.jsx)(l.A,{tip:"Loading...",spinning:s,fullscreen:!0}),t?(0,Le.jsxs)(r.A,{className:_e,align:"center",children:[(0,Le.jsx)(r.A,{children:"Filters: "}),(0,Le.jsx)(r.A,{className:xe,children:(0,Le.jsx)(oe.A,{classnames:be,options:v,onChange:e=>{const a=p.filter((a=>e.includes(a.id)));m(a),h(e)},mode:"multiple",maxTagCount:3,placeholder:"Select Users",value:y})}),(0,Le.jsx)(r.A,{className:xe,children:(0,Le.jsx)(Fe,{value:_,placeholder:"Select Date Range",onChange:e=>{b(e),x.current=e},allowClear:!1,maxDate:re()(),format:"MM-DD-YYYY"})})]}):null,(0,Le.jsxs)(r.A,{vertical:!0,className:me,children:[(0,Le.jsxs)(r.A,{className:pe,align:"center",children:[(0,Le.jsx)(r.A,{className:ge,children:"Performance Leaderboard"}),(0,Le.jsx)(r.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,Le.jsx)(r.A,{children:de["total leads assigned"]})}),(0,Le.jsx)(r.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,Le.jsx)(r.A,{children:de["leads assigned"]})}),(0,Le.jsx)(r.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,Le.jsx)(r.A,{children:de["disqualified leads"]})}),A.map((e=>(0,Le.jsx)(r.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,Le.jsx)(r.A,{children:de[e]})}))),(0,Le.jsx)(r.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,Le.jsx)(r.A,{children:de["conversion ratio"]})}),(0,Le.jsx)(r.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,Le.jsx)(r.A,{children:de["avg deal size"]})}),(0,Le.jsx)(r.A,{className:fe,vertical:!0,justify:"center",align:"center",children:(0,Le.jsx)(r.A,{children:de["avg time to fund"]})})]}),(0,Le.jsxs)(r.A,{className:u()(he),style:{backgroundColor:"#1a4049",color:"white"},children:[(0,Le.jsxs)(r.A,{className:ve,align:"center",children:[(0,Le.jsx)(r.A,{style:{marginRight:10},children:(0,Le.jsx)(ae,{children:"T"})}),(0,Le.jsx)(r.A,{children:"Totals"})]}),(0,Le.jsx)(r.A,{className:ye,justify:"center",align:"center",children:C.allLeadsAssigned||" "}),(0,Le.jsx)(r.A,{className:ye,justify:"center",align:"center",children:C.leadsAssigned||" "}),(0,Le.jsx)(r.A,{className:ye,justify:"center",align:"center",children:C.allLeadsDisqualified||" "}),A.map((e=>(0,Le.jsx)(r.A,{className:ye,justify:"center",align:"center",vertical:!0,children:(0,Le.jsx)(r.A,{children:C[e]||" "})}))),(0,Le.jsxs)(r.A,{className:ye,justify:"center",align:"center",children:[C.conversionRatio||" ",C.conversionRatio?"%":""]}),(0,Le.jsxs)(r.A,{className:ye,justify:"center",align:"center",children:["$",(0,le.qC)(C.averageFunds||"0")]}),(0,Le.jsx)(r.A,{className:ye,justify:"center",align:"center",children:C.averageDaysDifference||"0"})]}),d.map(((e,a)=>(0,Le.jsxs)(r.A,{className:u()(he,{[Ae]:a%2}),children:[(0,Le.jsxs)(r.A,{className:ve,align:"center",children:[(0,Le.jsx)(r.A,{style:{marginRight:10},children:e.photo_thumb?(0,Le.jsx)(ae,{src:e.photo_thumb}):(0,Le.jsx)(ae,{children:e.name[0]})}),(0,Le.jsx)(r.A,{children:e.name.split(" ")[0]})]}),(0,Le.jsx)(r.A,{className:ye,justify:"center",align:"center",children:(w[e.id]||{}).allLeadsAssigned||" "}),(0,Le.jsx)(r.A,{className:ye,justify:"center",align:"center",children:(w[e.id]||{}).leadsAssigned||" "}),(0,Le.jsx)(r.A,{className:ye,justify:"center",align:"center",children:(w[e.id]||{}).allLeadsDisqualified||" "}),A.map((a=>{const n=ue[a],t="leads assigned"===n?(w[e.id]||{}).leadsAssigned:(w[e.id]||{})[n],s=(w[e.id]||{})[a],o=t&&s?(s/t*100).toFixed(0):"";return(0,Le.jsxs)(r.A,{className:ye,justify:"center",align:"center",vertical:!0,children:[(0,Le.jsx)(r.A,{children:(w[e.id]||{})[a]||" "}),(0,Le.jsx)(r.A,{className:je,children:o?"".concat(o,"%"):""})]})})),(0,Le.jsxs)(r.A,{className:ye,justify:"center",align:"center",children:[(w[e.id]||{}).conversionRatio||" ",(w[e.id]||{}).conversionRatio?"%":""]}),(0,Le.jsxs)(r.A,{className:ye,justify:"center",align:"center",children:["$",(0,le.qC)((w[e.id]||{}).averageFunds||"0")]}),(0,Le.jsx)(r.A,{className:ye,justify:"center",align:"center",children:(w[e.id]||{}).averageDaysDifference||"0"})]})))]})]})};const Be=function(e){let{withFilter:a}=e;return(0,Le.jsx)(t.Ay,{theme:{token:{fontFamily:"Poppins"},components:{Layout:{bodyBg:"#E1EFF2",headerBg:"#E1EFF2"}}},children:(0,Le.jsx)(s.A,{style:{padding:"0 8px 24px"},children:(0,Le.jsx)(ke,{withFilter:a})})})}}}]);