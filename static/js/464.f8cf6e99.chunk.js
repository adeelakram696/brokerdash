"use strict";(self.webpackChunkbroker_dashboard=self.webpackChunkbroker_dashboard||[]).push([[464],{9464:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Fe});var n=t(5465),o=t(718),s=t(2746),r=t(4064),i=t(2612),c=t(9950),l=t(8738),d=t.n(l),u=t(7090),m=t(1929),p=t(6191),g=t(5741),f=t(5656),v=t(9415),y=t(183);const b=c.createContext({});var h=t(7409),_=t(5343),x=t(2672),j=t(1874);const A=e=>{const{antCls:a,componentCls:t,iconCls:n,avatarBg:o,avatarColor:s,containerSize:r,containerSizeLG:i,containerSizeSM:c,textFontSize:l,textFontSizeLG:d,textFontSizeSM:u,borderRadius:m,borderRadiusLG:p,borderRadiusSM:g,lineWidth:f,lineType:v}=e,y=(e,a,o)=>({width:e,height:e,borderRadius:"50%",["&".concat(t,"-square")]:{borderRadius:o},["&".concat(t,"-icon")]:{fontSize:a,["> ".concat(n)]:{margin:0}}});return{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,_.dF)(e)),{position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:s,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:o,border:"".concat((0,h.zA)(f)," ").concat(v," transparent"),"&-image":{background:"transparent"},["".concat(a,"-image-img")]:{display:"block"}}),y(r,l,m)),{"&-lg":Object.assign({},y(i,d,p)),"&-sm":Object.assign({},y(c,u,g)),"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}})}},S=e=>{const{componentCls:a,groupBorderColor:t,groupOverlapping:n,groupSpace:o}=e;return{["".concat(a,"-group")]:{display:"inline-flex",["".concat(a)]:{borderColor:t},"> *:not(:first-child)":{marginInlineStart:n}},["".concat(a,"-group-popover")]:{["".concat(a," + ").concat(a)]:{marginInlineStart:o}}}},O=(0,x.OF)("Avatar",(e=>{const{colorTextLightSolid:a,colorTextPlaceholder:t}=e,n=(0,j.h1)(e,{avatarBg:t,avatarColor:a});return[A(n),S(n)]}),(e=>{const{controlHeight:a,controlHeightLG:t,controlHeightSM:n,fontSize:o,fontSizeLG:s,fontSizeXL:r,fontSizeHeading3:i,marginXS:c,marginXXS:l,colorBorderBg:d}=e;return{containerSize:a,containerSizeLG:t,containerSizeSM:n,textFontSize:Math.round((s+r)/2),textFontSizeLG:i,textFontSizeSM:o,groupSpace:l,groupOverlapping:-c,groupBorderColor:d}}));var w=function(e,a){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)a.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t};const C=(e,a)=>{const[t,n]=c.useState(1),[o,s]=c.useState(!1),[r,i]=c.useState(!0),l=c.useRef(null),h=c.useRef(null),_=(0,m.K4)(a,l),{getPrefixCls:x,avatar:j}=c.useContext(g.QO),A=c.useContext(b),S=()=>{if(!h.current||!l.current)return;const a=h.current.offsetWidth,t=l.current.offsetWidth;if(0!==a&&0!==t){const{gap:o=4}=e;2*o<t&&n(t-2*o<a?(t-2*o)/a:1)}};c.useEffect((()=>{s(!0)}),[]),c.useEffect((()=>{i(!0),n(1)}),[e.src]),c.useEffect(S,[e.gap]);const C=()=>{const{onError:a}=e;!1!==(null===a||void 0===a?void 0:a())&&i(!1)},{prefixCls:z,shape:E,size:N,src:D,srcSet:k,icon:L,className:F,rootClassName:B,alt:P,draggable:R,children:M,crossOrigin:I}=e,T=w(e,["prefixCls","shape","size","src","srcSet","icon","className","rootClassName","alt","draggable","children","crossOrigin"]),q=(0,v.A)((e=>{var a,t;return null!==(t=null!==(a=null!==N&&void 0!==N?N:null===A||void 0===A?void 0:A.size)&&void 0!==a?a:e)&&void 0!==t?t:"default"})),W=Object.keys("object"===typeof q&&q||{}).some((e=>["xs","sm","md","lg","xl","xxl"].includes(e))),G=(0,y.A)(W),Y=c.useMemo((()=>{if("object"!==typeof q)return{};const e=p.ye.find((e=>G[e])),a=q[e];return a?{width:a,height:a,fontSize:a&&(L||M)?a/2:18}:{}}),[G,q]);const K=x("avatar",z),H=(0,f.A)(K),[V,X,Q]=O(K,H),U=d()({["".concat(K,"-lg")]:"large"===q,["".concat(K,"-sm")]:"small"===q}),Z=c.isValidElement(D),J=E||(null===A||void 0===A?void 0:A.shape)||"circle",$=d()(K,U,null===j||void 0===j?void 0:j.className,"".concat(K,"-").concat(J),{["".concat(K,"-image")]:Z||D&&r,["".concat(K,"-icon")]:!!L},Q,H,F,B,X),ee="number"===typeof q?{width:q,height:q,fontSize:L?q/2:18}:{};let ae;if("string"===typeof D&&r)ae=c.createElement("img",{src:D,draggable:R,srcSet:k,onError:C,alt:P,crossOrigin:I});else if(Z)ae=D;else if(L)ae=L;else if(o||1!==t){const e="scale(".concat(t,")"),a={msTransform:e,WebkitTransform:e,transform:e};ae=c.createElement(u.A,{onResize:S},c.createElement("span",{className:"".concat(K,"-string"),ref:h,style:Object.assign({},a)},M))}else ae=c.createElement("span",{className:"".concat(K,"-string"),style:{opacity:0},ref:h},M);return delete T.onError,delete T.gap,V(c.createElement("span",Object.assign({},T,{style:Object.assign(Object.assign(Object.assign(Object.assign({},ee),Y),null===j||void 0===j?void 0:j.style),T.style),className:$,ref:_}),ae))};const z=c.forwardRef(C);var E=t(604),N=t(9156),D=t(1207),k=t(1478);const L=e=>e?"function"===typeof e?e():e:null;var F=t(9437),B=t(6680),P=t(9888),R=t(8691),M=t(6871),I=t(1201),T=t(8704);const q=e=>{const{componentCls:a,popoverColor:t,titleMinWidth:n,fontWeightStrong:o,innerPadding:s,boxShadowSecondary:r,colorTextHeading:i,borderRadiusLG:c,zIndexPopup:l,titleMarginBottom:d,colorBgElevated:u,popoverBg:m,titleBorderBottom:p,innerContentPadding:g,titlePadding:f}=e;return[{[a]:Object.assign(Object.assign({},(0,_.dF)(e)),{position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:l,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","--antd-arrow-background-color":u,width:"max-content",maxWidth:"100vw","&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},["".concat(a,"-content")]:{position:"relative"},["".concat(a,"-inner")]:{backgroundColor:m,backgroundClip:"padding-box",borderRadius:c,boxShadow:r,padding:s},["".concat(a,"-title")]:{minWidth:n,marginBottom:d,color:i,fontWeight:o,borderBottom:p,padding:f},["".concat(a,"-inner-content")]:{color:t,padding:g}})},(0,M.Ay)(e,"var(--antd-arrow-background-color)"),{["".concat(a,"-pure")]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow,display:"inline-block",["".concat(a,"-content")]:{display:"inline-block"}}}]},W=e=>{const{componentCls:a}=e;return{[a]:T.s.map((t=>{const n=e["".concat(t,"6")];return{["&".concat(a,"-").concat(t)]:{"--antd-arrow-background-color":n,["".concat(a,"-inner")]:{backgroundColor:n},["".concat(a,"-arrow")]:{background:"transparent"}}}}))}},G=(0,x.OF)("Popover",(e=>{const{colorBgElevated:a,colorText:t}=e,n=(0,j.h1)(e,{popoverBg:a,popoverColor:t});return[q(n),W(n),(0,R.aB)(n,"zoom-big")]}),(e=>{const{lineWidth:a,controlHeight:t,fontHeight:n,padding:o,wireframe:s,zIndexPopupBase:r,borderRadiusLG:i,marginXS:c,lineType:l,colorSplit:d,paddingSM:u}=e,m=t-n,p=m/2,g=m/2-a,f=o;return Object.assign(Object.assign(Object.assign({titleMinWidth:177,zIndexPopup:r+30},(0,I.n)(e)),(0,M.Ke)({contentRadius:i,limitVerticalRadius:!0})),{innerPadding:s?0:12,titleMarginBottom:s?0:c,titlePadding:s?"".concat(p,"px ").concat(f,"px ").concat(g,"px"):0,titleBorderBottom:s?"".concat(a,"px ").concat(l," ").concat(d):"none",innerContentPadding:s?"".concat(u,"px ").concat(f,"px"):0})}),{resetStyle:!1,deprecatedTokens:[["width","titleMinWidth"],["minWidth","titleMinWidth"]]});var Y=function(e,a){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)a.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t};const K=e=>{const{hashId:a,prefixCls:t,className:n,style:o,placement:s="top",title:r,content:i,children:l}=e;return c.createElement("div",{className:d()(a,t,"".concat(t,"-pure"),"".concat(t,"-placement-").concat(s),n),style:o},c.createElement("div",{className:"".concat(t,"-arrow")}),c.createElement(P.z,Object.assign({},e,{className:a,prefixCls:t}),l||((e,a,t)=>a||t?c.createElement(c.Fragment,null,a&&c.createElement("div",{className:"".concat(e,"-title")},L(a)),c.createElement("div",{className:"".concat(e,"-inner-content")},L(t))):null)(t,r,i)))},H=e=>{const{prefixCls:a,className:t}=e,n=Y(e,["prefixCls","className"]),{getPrefixCls:o}=c.useContext(g.QO),s=o("popover",a),[r,i,l]=G(s);return r(c.createElement(K,Object.assign({},n,{prefixCls:s,hashId:i,className:d()(t,l)})))};var V=function(e,a){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)a.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t};const X=e=>{let{title:a,content:t,prefixCls:n}=e;return c.createElement(c.Fragment,null,a&&c.createElement("div",{className:"".concat(n,"-title")},L(a)),c.createElement("div",{className:"".concat(n,"-inner-content")},L(t)))},Q=c.forwardRef(((e,a)=>{var t,n;const{prefixCls:o,title:s,content:r,overlayClassName:i,placement:l="top",trigger:u="hover",children:m,mouseEnterDelay:p=.1,mouseLeaveDelay:f=.1,onOpenChange:v,overlayStyle:y={}}=e,b=V(e,["prefixCls","title","content","overlayClassName","placement","trigger","children","mouseEnterDelay","mouseLeaveDelay","onOpenChange","overlayStyle"]),{getPrefixCls:h}=c.useContext(g.QO),_=h("popover",o),[x,j,A]=G(_),S=h(),O=d()(i,j,A),[w,C]=(0,D.A)(!1,{value:null!==(t=e.open)&&void 0!==t?t:e.visible,defaultValue:null!==(n=e.defaultOpen)&&void 0!==n?n:e.defaultVisible}),z=(e,a)=>{C(e,!0),null===v||void 0===v||v(e,a)};return x(c.createElement(B.A,Object.assign({placement:l,trigger:u,mouseEnterDelay:p,mouseLeaveDelay:f,overlayStyle:y},b,{prefixCls:_,overlayClassName:O,ref:a,open:w,onOpenChange:e=>{z(e)},overlay:s||r?c.createElement(X,{prefixCls:_,title:s,content:r}):null,transitionName:(0,F.b)(S,"zoom-big",b.transitionName),"data-popover-inject":!0}),(0,N.Ob)(m,{onKeyDown:e=>{var a,t;c.isValidElement(m)&&(null===(t=null===m||void 0===m?void 0:(a=m.props).onKeyDown)||void 0===t||t.call(a,e)),(e=>{e.keyCode===k.A.ESC&&z(!1,e)})(e)}})))}));Q._InternalPanelDoNotUseOrYouWillBeFired=H;const U=Q,Z=e=>{const{size:a,shape:t}=c.useContext(b),n=c.useMemo((()=>({size:e.size||a,shape:e.shape||t})),[e.size,e.shape,a,t]);return c.createElement(b.Provider,{value:n},e.children)},J=e=>{const{getPrefixCls:a,direction:t}=c.useContext(g.QO),{prefixCls:n,className:o,rootClassName:s,style:r,maxCount:i,maxStyle:l,size:u,shape:m,maxPopoverPlacement:p="top",maxPopoverTrigger:v="hover",children:y}=e,b=a("avatar",n),h="".concat(b,"-group"),_=(0,f.A)(b),[x,j,A]=O(b,_),S=d()(h,{["".concat(h,"-rtl")]:"rtl"===t},A,_,o,s,j),w=(0,E.A)(y).map(((e,a)=>(0,N.Ob)(e,{key:"avatar-key-".concat(a)}))),C=w.length;if(i&&i<C){const e=w.slice(0,i),a=w.slice(i,C);return e.push(c.createElement(U,{key:"avatar-popover-key",content:a,trigger:v,placement:p,overlayClassName:"".concat(h,"-popover"),destroyTooltipOnHide:!0},c.createElement(z,{style:l},"+".concat(C-i)))),x(c.createElement(Z,{shape:m,size:u},c.createElement("div",{className:S,style:r},e)))}return x(c.createElement(Z,{shape:m,size:u},c.createElement("div",{className:S,style:r},w)))},$=z;$.Group=J;const ee=$;var ae=t(4051),te=t(326),ne=t(859),oe=t(6541),se=t(4159),re=t.n(se),ie=t(6338),ce=t(9379);const le=["Follow up call","Deal Submitted","Offer Received Back","Fully funded"],de={"total leads assigned":"# of Active Leads Assinged","leads assigned":"# of Leads Assinged","disqualified leads":"# of Leads Disqualified","follow up call":"Attempted Calls","deal submitted":"Deal Submitted","offer received back":"Offers Ready","contract out":"Contract out","contract signed":"Contract Signed","fully funded":"Deals Funded","client rejected":"Client Rejected",declined:"Declined",disqualified:"Disqualified","conversion ratio":"Conversion Ratio (Funded/Approvals)","avg deal size":"Avg Funded Deal Size","avg time to fund":"Avg Time from Application to Funded"},ue={"deal submitted":"leads assigned","offer received back":"deal submitted","fully funded":"offer received back"},me="LeaderBoards_table__u3STH",pe="LeaderBoards_headerRow__Bv7Lq",ge="LeaderBoards_headerColumnTitle__BbeRM",fe="LeaderBoards_dataColumnTitle__bj7wK",ve="LeaderBoards_headerColumnPerson__JzV2F",ye="LeaderBoards_dataColumnPerson__V8O69",be="LeaderBoards_dataRow__H-WEt",he="LeaderBoards_filterbar__nKucZ",_e="LeaderBoards_usersList__4ySG9",xe="LeaderBoards_filterField__14bMZ",je="LeaderBoards_alternateColor__iGVHE",Ae="LeaderBoards_percentage__J7lGV";var Se=t(1397),Oe=t.n(Se);const we=async(e,a)=>{const t=a.map((e=>'"person-'.concat(e.id,'"'))),n="query {\n    boards(ids: [".concat(te._K.boards.leads,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.leads.assginee,'", compare_value: [').concat(t,'], operator: any_of}\n            { column_id: "').concat(te.zu.leads.stage,'", compare_value: [11,14], operator: not_any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.leads.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }');return await ne.A.api(n)},Ce=async(e,a)=>{var t,n,o,s;const r=a.map((e=>'"person-'.concat(e.id,'"'))),i="query {\n    boards(ids: [".concat(te._K.boards.deals,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.deals.assginee,'", compare_value: [').concat(r,'], operator: any_of}\n            { column_id: "').concat(te.zu.deals.stage,'", compare_value: [1,5,6,8,9,10,11,14], operator: not_any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.deals.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }'),c=await ne.A.api(i);return null!==c&&void 0!==c&&null!==(t=c.data)&&void 0!==t&&null!==(n=t.boards)&&void 0!==n&&null!==(o=n[0])&&void 0!==o&&null!==(s=o.items_page)&&void 0!==s&&s.items&&(c.data.boards[0].items_page.items=c.data.boards[0].items_page.items.map((e=>(0,ce.A)((0,ce.A)({},e),{},{isDeal:!0})))),c},ze=async(e,a,t)=>{const n=a.map((e=>'"person-'.concat(e.id,'"'))),o="query {\n    boards(ids: [".concat(te._K.boards.leads,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.deals.last_rep_assigned_date,'", compare_value: [').concat(t,'], operator: between }\n            { column_id: "').concat(te.zu.leads.assginee,'", compare_value: [').concat(n,'], operator: any_of}\n            { column_id: "').concat(te.zu.leads.stage,'", compare_value: [11], operator: any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.leads.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }');return await ne.A.api(o)},Ee=async(e,a,t)=>{var n,o,s,r;const i=a.map((e=>'"person-'.concat(e.id,'"'))),c="query {\n    boards(ids: [".concat(te._K.boards.deals,"]) {\n      items_page(\n        ").concat(e?"":'query_params: {\n          rules: [\n            { column_id: "'.concat(te.zu.deals.last_rep_assigned_date,'", compare_value: [').concat(t,'], operator: between }\n            { column_id: "').concat(te.zu.deals.assginee,'", compare_value: [').concat(i,'], operator: any_of}\n            { column_id: "').concat(te.zu.deals.stage,'", compare_value: [9], operator: any_of}\n          ]\n        }'),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.deals.assginee,'"]) {\n            id\n            text\n            value\n          }\n        }\n      }\n    }\n  }'),l=await ne.A.api(c);return null!==l&&void 0!==l&&null!==(n=l.data)&&void 0!==n&&null!==(o=n.boards)&&void 0!==o&&null!==(s=o[0])&&void 0!==s&&null!==(r=s.items_page)&&void 0!==r&&r.items&&(l.data.boards[0].items_page.items=l.data.boards[0].items_page.items.map((e=>(0,ce.A)((0,ce.A)({},e),{},{isDeal:!0})))),l},Ne=async(e,a,t)=>{const n=a.map((e=>'"person-'.concat(e.id,'"'))),o="query {\n    totalFunds: boards(ids: [".concat(te._K.boards.deals,"]) {\n      items_page(\n      ").concat(e?"":'query_params: {\n        rules: [\n          { column_id: "'.concat(te.zu.deals.funded__date,'", compare_value: [').concat(t,'], operator: between}\n          { column_id: "').concat(te.zu.deals.assginee,'", compare_value: [').concat(n,"], operator: any_of}\n       ]\n       }"),"\n        limit: 500\n        ").concat(e?'cursor: "'.concat(e,'"'):"",'\n      ) {\n        cursor\n        items {\n          id\n          name\n          column_values(ids: ["').concat(te.zu.deals.assginee,'", "').concat(te.zu.deals.last_rep_assigned_date,'", "').concat(te.zu.deals.funded__date,'"]) {\n            id\n            text\n            value\n          }\n          subitems {\n            id\n            name\n            column_values (ids: ["').concat(te.zu.subItem.status,'", "').concat(te.zu.subItem.funding_amount,'"]) {\n              id\n              text\n              value\n            }\n          }\n        }\n      }\n    }\n  }');return await ne.A.api(o)};var De=t(4414);const{RangePicker:ke}=s.A;const Le=function(e){let a,t,{withFilter:n}=e;const[o,s]=(0,c.useState)(!1),[l,u]=(0,c.useState)(!1),[m,p]=(0,c.useState)([]),[g,f]=(0,c.useState)([]),[v,y]=(0,c.useState)([]),[b,h]=(0,c.useState)([]),[_,x]=(0,c.useState)([re()(),re()()]),j=(0,c.useRef)(),[A,S]=(0,c.useState)([]),[O,w]=(0,c.useState)([]),[C,z]=(0,c.useState)([]),E=async()=>{const e=await(0,ae.iE)(te._K.boards.salesActivities,"status"),a=Object.values(e).reduce(((e,a)=>(e[a.toLowerCase()]=a.toLowerCase(),e)),{}),t=le.map((e=>e.toLowerCase())),n=(0,ie.Ye)(Object.keys(a),t,!0);S(n)},N=async()=>{const e=await(0,ae.Wd)();if(p(e),n){const a=null===e||void 0===e?void 0:e.map((e=>e.id));h(a)}},D=async function(e){s(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]);const a=await(0,ae.EU)(e);w(a),s(!1)},k=async function(e,a){u(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]);const t=await(0,ae.D5)(e,a),n=await(async(e,a)=>{let t=null,n=[];const o=a.map((e=>'"'.concat(e.format("YYYY-MM-DD"),'"')));do{var s,r,i;t=await Ne(t?((null===(r=t.data)||void 0===r?void 0:r.totalFunds)||[])[0].items_page.cursor:null,e,o),n=[...n,...((null===(i=t.data)||void 0===i?void 0:i.totalFunds)||[])[0].items_page.items]}while(((null===(s=t.data)||void 0===s?void 0:s.totalFunds)||[])[0].items_page.cursor);const c=n.reduce(((a,t)=>{const n=a,o=t.subitems.find((e=>e.column_values.find((e=>e.id===te.zu.subItem.status&&"Selected"===e.text))));if(!o)return n;const s=(0,ie.oG)(t.column_values||[],te.zu.deals.assginee);if(Oe().isEmpty(s))return n;const r=e.find((e=>s.personsAndTeams[0].id===Number(e.id)));if(!r)return n;const i="totalfunds",c="fully funded",l=(0,ie.oG)(t.column_values||[],te.zu.deals.last_rep_assigned_date),d=(0,ie.oG)(t.column_values||[],te.zu.deals.funded__date),u=(0,ie.IZ)(o.column_values[1].text),m=(0,ie.uS)(null===l||void 0===l?void 0:l.date,null===d||void 0===d?void 0:d.date);return n[r.id]?(n[r.id][i]+=u,n[r.id][c]+=1,n[r.id].totalDaysDifference+=m,n[r.id].totalDeals+=1):n[r.id]={[i]:u,[c]:1,totalDaysDifference:m,totalDeals:1,person:r},n}),{});return Object.keys(c).forEach((e=>{const a=c[e],t=a.totalfunds/a.totalDeals,n=a.totalDaysDifference/a.totalDeals;c[e]=(0,ce.A)((0,ce.A)({},a),{},{averageFunds:t.toFixed(2),averageDaysDifference:Math.round(n)})})),c})(a,e),o=await(async e=>{let a=null,t=[];do{a=await we(a?a.data.boards[0].items_page.cursor:null,e),t=[...t,...a.data.boards[0].items_page.items]}while(a.data.boards[0].items_page.cursor);do{a=await Ce(a?a.data.boards[0].items_page.cursor:null,e),t=[...t,...a.data.boards[0].items_page.items]}while(a.data.boards[0].items_page.cursor);return t.reduce(((a,t)=>{const n=(0,ie.oG)(t.column_values||[],t.isDeal?te.zu.deals.assginee:te.zu.leads.assginee),o=a;if(Oe().isEmpty(n))return o;const s=e.find((e=>n.personsAndTeams[0].id===Number(e.id)));return s?(o[s.id]?o[s.id]+=1:o[s.id]=1,o):o}),{})})(a),s=await(async(e,a)=>{const t=a.map((e=>'"'.concat(e.format("YYYY-MM-DD"),'"')));let n=null,o=[];do{n=await ze(n?n.data.boards[0].items_page.cursor:null,e,t),o=[...o,...n.data.boards[0].items_page.items]}while(n.data.boards[0].items_page.cursor);do{n=await Ee(n?n.data.boards[0].items_page.cursor:null,e,t),o=[...o,...n.data.boards[0].items_page.items]}while(n.data.boards[0].items_page.cursor);return o.reduce(((a,t)=>{const n=(0,ie.oG)(t.column_values||[],t.isDeal?te.zu.deals.assginee:te.zu.leads.assginee),o=a;if(Oe().isEmpty(n))return o;const s=e.find((e=>n.personsAndTeams[0].id===Number(e.id)));return s?(o[s.id]?o[s.id]+=1:o[s.id]=1,o):o}),{})})(a,e),r=((e,a,t,n,o)=>{const s={};return Object.keys(e).forEach((a=>{var t;s[a]||(s[a]={person:o.find((e=>e.id===a))}),s[a].leadsAssigned=(null===(t=e[a])||void 0===t?void 0:t.count)||0})),Object.keys(t).forEach((e=>{s[e]||(s[e]={person:o.find((a=>a.id===e))}),s[e].allLeadsAssigned=t[e]||0})),Object.keys(n).forEach((e=>{s[e]||(s[e]={person:o.find((a=>a.id===e))}),s[e].allLeadsDisqualified=n[e]||0})),Object.keys(a).forEach((e=>{s[e]||(s[e]={person:{id:e}}),s[e]=(0,ce.A)((0,ce.A)({},s[e]),a[e])})),Object.keys(s).forEach((e=>{const a=s[e],t=a["offer received back"]||0,n=a["fully funded"]||0;a.conversionRatio=t>0?"".concat((n/t*100).toFixed(2),"%"):"0%"})),s})(t,n,o,s,a);console.log(r),z(r),u(!1)};(0,c.useEffect)((()=>{N(),E(),j.current=[re()(),re()()],n&&(async()=>{const e=await(0,ae.Ym)(),a=null===e||void 0===e?void 0:e.map((e=>({value:e.id,label:e.name})));f(e),y(a)})()}),[]),(0,c.useEffect)((()=>{0!==m.length&&(D(_),k(_,m))}),[m,_]);const L=e=>{let{data:a}=e;a.itemIds.includes(Number(te._K.leaderEmployeeItemId))&&(t&&clearTimeout(t),t=setTimeout((()=>{N()}),3e3))};return(0,c.useEffect)((()=>n?null:(a=ne.A.listen("events",L),()=>{a&&a()})),[]),(0,c.useEffect)((()=>{if(n)return null;const e=setInterval((()=>{var e;e=j.current,E(),D(e,!1),k(_,m,!1)}),1e3*te._K.performanceRefetchTime);return()=>{e&&clearInterval(e)}}),[]),(0,De.jsxs)(r.A,{vertical:!0,flex:1,children:[(0,De.jsx)(i.A,{tip:"Loading...",spinning:o||l,fullscreen:!0}),n?(0,De.jsxs)(r.A,{className:he,align:"center",children:[(0,De.jsx)(r.A,{children:"Filters: "}),(0,De.jsx)(r.A,{className:xe,children:(0,De.jsx)(oe.A,{classnames:_e,options:v,onChange:e=>{const a=g.filter((a=>e.includes(a.id)));p(a),h(e)},mode:"multiple",maxTagCount:3,placeholder:"Select Users",value:b})}),(0,De.jsx)(r.A,{className:xe,children:(0,De.jsx)(ke,{value:_,placeholder:"Select Date Range",onChange:e=>{x(e),j.current=e},allowClear:!1,maxDate:re()(),format:"MM-DD-YYYY"})})]}):null,(0,De.jsxs)(r.A,{vertical:!0,className:me,children:[(0,De.jsxs)(r.A,{className:pe,align:"center",children:[(0,De.jsx)(r.A,{className:ge,children:"Performance Leaderboard"}),(0,De.jsx)(r.A,{className:ve,vertical:!0,justify:"center",align:"center",children:(0,De.jsx)(r.A,{children:de["total leads assigned"]})}),(0,De.jsx)(r.A,{className:ve,vertical:!0,justify:"center",align:"center",children:(0,De.jsx)(r.A,{children:de["leads assigned"]})}),(0,De.jsx)(r.A,{className:ve,vertical:!0,justify:"center",align:"center",children:(0,De.jsx)(r.A,{children:de["disqualified leads"]})}),A.map((e=>(0,De.jsx)(r.A,{className:ve,vertical:!0,justify:"center",align:"center",children:(0,De.jsx)(r.A,{children:de[e]})}))),(0,De.jsx)(r.A,{className:ve,vertical:!0,justify:"center",align:"center",children:(0,De.jsx)(r.A,{children:de["conversion ratio"]})}),(0,De.jsx)(r.A,{className:ve,vertical:!0,justify:"center",align:"center",children:(0,De.jsx)(r.A,{children:de["avg deal size"]})}),(0,De.jsx)(r.A,{className:ve,vertical:!0,justify:"center",align:"center",children:(0,De.jsx)(r.A,{children:de["avg time to fund"]})})]}),m.map(((e,a)=>(0,De.jsxs)(r.A,{className:d()(be,{[je]:a%2}),children:[(0,De.jsxs)(r.A,{className:fe,align:"center",children:[(0,De.jsx)(r.A,{style:{marginRight:10},children:e.photo_thumb?(0,De.jsx)(ee,{src:e.photo_thumb}):(0,De.jsx)(ee,{children:e.name[0]})}),(0,De.jsx)(r.A,{children:e.name.split(" ")[0]})]}),(0,De.jsx)(r.A,{className:ye,justify:"center",align:"center",children:(C[e.id]||{}).allLeadsAssigned||" "}),(0,De.jsx)(r.A,{className:ye,justify:"center",align:"center",children:(C[e.id]||{}).leadsAssigned||" "}),(0,De.jsx)(r.A,{className:ye,justify:"center",align:"center",children:(C[e.id]||{}).allLeadsDisqualified||" "}),A.map((a=>{const t=ue[a],n="leads assigned"===t?(C[e.id]||{}).leadsAssigned:(O[t]||{})[e.id],o=(O[a]||{})[e.id],s=n&&o?(o/n*100).toFixed(0):"";return(0,De.jsxs)(r.A,{className:ye,justify:"center",align:"center",vertical:!0,children:[(0,De.jsx)(r.A,{children:(O[a]||{})[e.id]||" "}),(0,De.jsx)(r.A,{className:Ae,children:s?"".concat(s,"%"):""})]})})),(0,De.jsx)(r.A,{className:ye,justify:"center",align:"center",children:(C[e.id]||{}).conversionRatio||" "}),(0,De.jsxs)(r.A,{className:ye,justify:"center",align:"center",children:["$",(C[e.id]||{}).averageFunds||"0"]}),(0,De.jsx)(r.A,{className:ye,justify:"center",align:"center",children:(C[e.id]||{}).averageDaysDifference||"0"})]})))]})]})};const Fe=function(e){let{withFilter:a}=e;return(0,De.jsx)(n.Ay,{theme:{token:{fontFamily:"Poppins"},components:{Layout:{bodyBg:"#E1EFF2",headerBg:"#E1EFF2"}}},children:(0,De.jsx)(o.A,{style:{padding:"0 8px 24px"},children:(0,De.jsx)(Le,{withFilter:a})})})}}}]);